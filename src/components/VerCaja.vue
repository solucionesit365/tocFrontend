<template>
    <div class="row justify-content-center mt-4">
        <div class="col-7">
            <div class="card">
                <div class="card-header">
                    <h4>Ãšltimo cierre de caja</h4>
                </div>
                <div class="card-body">
                    <div class="row row-2">
                        <div class="col-6">
                            <h6 class="text-center">Detalle</h6>
                            <div class="card">
                                <div class="card-body">
                                    <div class="text-muted">
                                        <div class="row row-2">
                                            <div class="col-4">Resp:</div>
                                            <div class="col-8 text-start">{{name}}</div>

                                            <div class="col-4">Inici:</div>
                                            <div class="col-8 text-start">{{inicioTime}}</div>

                                            <div class="col-4">Final:</div>
                                            <div class="col-8 text-start">{{finalTime}}</div>
                                            
                                            <div class="col-6  mb-2 mt-4">Calaix fet:</div>
                                            <div class="col-4 mb-2 mt-4 text-start">{{calaixFetZ}}</div>

                                            <div class="col-6 mt-2">Descuadre:</div>
                                            <div class="col-4 mt-2 text-start">{{descuadre}}</div>

                                            <div class="col-6 mt-2">Clients atessos:</div>
                                            <div class="col-4 mt-2 text-start">{{nClientes}}</div>
                                            
                                            <div class="col-6 mt-2">Rescaudat:</div>
                                            <div class="col-4 mt-2 text-start">{{recaudado}}</div>

                                            <div class="col-6 mt-2">Total 3G:</div>
                                            <div class="col-4 mt-2 text-start">{{totalDatafono3G}}</div>

                                            <div class="col-6 mt-2">Canvi inicial:</div>
                                            <div class="col-4 mt-2 text-start">{{cambioInicial}}</div>

                                            <div class="col-6 mt-2">Canvi final:</div>
                                            <div class="col-4 mt-2 text-start">{{cambioFinal}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-6 overflow-scroll">
                            <h6 class="text-center">Moviments de Caixa</h6>
                            <div class="card mb-2" v-for="(item, index) in moviments" v-bind:key="index">
                                <div class="card-body">
                                    <div class="row row-2 text-muted">
                                        <div class="col-4">Cantidad: </div>
                                        <div class="col-6 text-start">{{ item.cantidad }}</div>
                                        <div class="col-4">Fecha: </div>
                                        <div class="col-6 text-start">{{ item.fecha }}</div>
                                        <div class="col-4">Concepto: </div>
                                        <div class="col-6 text-start">{{ item.concepto }}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-footer text-center">
                    <button @click="imprimirUltimoCierre()" type="button" class="btn botonesPrincipales w-50">
                        <i class="bi bi-printer-fill fs-3"></i>
                    </button>
</div>
            </div>
        </div>
    </div>
</template>

<script>
import { ref, computed, onMounted } from 'vue';
import { Modal } from 'bootstrap';
import axios from 'axios';
import router from '../router/index';
import { useStore } from 'vuex';
import { useToast } from 'vue-toastification';

export default {
  name: 'VerCaja',
  setup() {
    const toast = useToast();
    const store = useStore();
    const activo = ref(0);

    const name = ref(0);
    const inicioTime = ref(0);
    const finalTime = ref(0);
    const calaixFetZ = ref(0);
    const descuadre = ref(0);
    const totalDatafono3G = ref(0);
    const nClientes = ref(0);
    const moviments = ref([{cantidad: 10, fecha:19, concepto:"droga" }, {}]);
    const cambioInicial = ref(0);
    const cambioFinal = ref(0);
    const recaudado = ref(0);
  

    function setActivo(x) {
      activo.value = x;
    }

    function volver() {
      router.push('/menu/caja');
    }


   





    onMounted(() => {
      axios.post('/caja/getDatosUltimoCierre').then((arrayVerCajas) => {
        console.log(arrayVerCajas.data.info);
              name.value = arrayVerCajas.data.info.idDependienta;
              inicioTime.value = new Date(arrayVerCajas.data.info.inicioTime);
              finalTime.value = new Date(arrayVerCajas.data.info.finalTime);
              calaixFetZ.value = arrayVerCajas.data.info.calaixFetZ;
              totalDatafono3G.value = arrayVerCajas.data.info.totalDatafono3G;
              descuadre.value = arrayVerCajas.data.info.descuadre;
              nClientes.value = arrayVerCajas.data.info.nClientes;
              recaudado.value = arrayVerCajas.data.info.recaudado;
              cambioInicial.value = arrayVerCajas.data.info.infoExtra.cambioInicial;
              cambioFinal.value = arrayVerCajas.data.info.infoExtra.cambioFinal;
        // setTicketActivo('', true);
      });
    });




   


    // onMounted(() => {
    //   modalConfirmacionClausura = new Modal(document.getElementById('modalConfirmacionClausura'), {
    //     keyboard: false,
    //   });

    //   let infoTemporal = JSON.parse(localStorage.getItem("infoDinero"));
    //   if (infoTemporal) {
    //     infoDinero.value = infoTemporal;
    //   }

    // });

    return {
        name,
      inicioTime, 
      finalTime, 
      calaixFetZ,
      totalDatafono3G, 
      descuadre,
      recaudado,
      nClientes,
      cambioInicial,
      cambioFinal,
      moviments
    };
  },
};
</script>
<style scoped>
    .infoDineros {
        color: red;
        font-weight: bold;
    }
    .colorTexto {
        color: #c95907;
    }

    .totalStyle {
        font-size: 60px;
        font-weight: bold;
    }
  .botonesCalculadora {
    background-color: #fff5e9;
    color: #c95907;
    border-width: 3px;
    border: 1px solid #bf5c18;
  }
  .unidadesSize {
    font-size: 25px;
  }

  .total3GInput {
    font-size: 2rem;
  }
</style>
